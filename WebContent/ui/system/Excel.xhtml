<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/common/commonLayout.xhtml">
                
   <ui:define name="content">
   
   		
   		<h:form id="manageProposal" >
			<p:growl escape="false" globalOnly="true" life="5000"
				showDetail="true" />
			<h:outputText value="Add New Proposal" styleClass="title"
				rendered="#{ManageProposalActionBean.createNew and ManageProposalActionBean.showExcel}" />
			<h:outputText value="Update Proposal" styleClass="title"
				rendered="#{!ManageProposalActionBean.createNew and ManageProposalActionBean.showExcel }" />
			<p:panel rendered="#{ManageProposalActionBean.showExcel}">
				<p:panelGrid id="panelDept" columns="2"
					columnClasses="ui-grid-col-6,ui-grid-col-6" layout="grid"
					styleClass="ui-panelgrid-blank ui-fluid">

					<p:panelGrid columns="2"
						columnClasses="ui-grid-col-3,ui-grid-col-6" layout="grid"
						styleClass="ui-panelgrid-blank ui-fluid">
						<h:outputText value="" />

						<p:message display="text" for="name" />
						<h:outputText for="name" value="Insured Name"
							styleClass="input-label mandatory" escape="false" />
						<p:inputText
							value="#{ManageProposalActionBean.proposalDTO.insuredName}"
							id="name" required="true">
							<f:validateLength maximum="50" />
						</p:inputText>

						<h:outputText value="" />

						<p:message display="text" for="bank" />
						<h:outputText for="bank" value="Bank"
							styleClass="input-label mandatory" escape="false" />
						<p:inputText value="#{ManageProposalActionBean.proposalDTO.bank}"
							id="bank" required="true">
						</p:inputText>

						<h:outputText value="" />

						<p:message display="text" for="address" />
						<h:outputText for="address" value="Address"
							styleClass="input-label" escape="false" />
						<p:inputText id="address"
							value="#{ManageProposalActionBean.proposalDTO.address}"
							required="true">
							<f:validateLength maximum="100" />
						</p:inputText>

						<h:outputText value="" />

						<p:message display="text" for="policyno" />
						<h:outputText for="policyno" value="Policy No"
							styleClass="input-label" escape="false" />
						<p:inputText id="policyno"
							value="#{ManageProposalActionBean.proposalDTO.policyNo}"
							required="true">
							<f:validateLength maximum="100" />
						</p:inputText>


						<h:outputText value="" />

						<p:message display="text" for="sumInsured" />
						<h:outputText for="sumInsured" value="SumInsured"
							styleClass="input-label" escape="false" />
						<p:inputText id="sumInsured"
							value="#{ManageProposalActionBean.proposalDTO.sumInsured}"
							required="true">
							<f:validateLength maximum="100" />
						</p:inputText>

					</p:panelGrid>
					<p:panelGrid columns="2"
						columnClasses="ui-grid-col-3,ui-grid-col-6" layout="grid"
						styleClass="ui-panelgrid-blank ui-fluid">


						<h:outputText value="" />

						<p:message display="text" for="rate" />
						<h:outputText for="rate" value="Rate" styleClass="input-label"
							escape="false" />
						<p:inputText id="rate"
							value="#{ManageProposalActionBean.proposalDTO.rate}"
							required="true">
							<f:validateLength maximum="100" />
						</p:inputText>

						<h:outputText value="" />

						<p:message display="text" for="premium" />
						<h:outputText for="premium" value="Premium"
							styleClass="input-label" escape="false" />
						<p:inputText id="premium"
							value="#{ManageProposalActionBean.proposalDTO.premium}"
							required="true">
							<f:validateLength maximum="100" />
						</p:inputText>

						<h:outputText value="" />

						<p:message display="text" for="startDate" />
						<h:outputText for="startDate" value="Start Date"
							styleClass="input-label mandatory" escape="false" />
						<p:datePicker id="startDate"
							value="#{ManageProposalActionBean.proposalDTO.startDate}"
							required="true" showIcon="true" />

						<h:outputText value="" />

						<p:message display="text" for="remark" />
						<h:outputText for="remark" value="Remark"
							styleClass="input-label mandatory" escape="false" />
						<p:inputTextarea id="remark"
							value="#{ManageProposalActionBean.proposalDTO.remark}"
							required="true">
							<f:validateLength maximum="100" />
						</p:inputTextarea>


						<h:outputText value="" />
						<h:outputText value="" />

					</p:panelGrid>
				</p:panelGrid>
			</p:panel>

			<br />

			<h:panelGrid columns="3" style="margin-top:-2px;">
				<p:commandButton id="addBtn" value="Submit"
					action="#{ManageProposalActionBean.softInserted()}"
					rendered="#{ManageProposalActionBean.createNew and ManageProposalActionBean.showExcel}"
					update=":excelTable :manageProposal" style="width:65px;" />
				<p:commandButton id="editBtn" value="Update"
					action="#{ManageProposalActionBean.softUpdated}"
					rendered="#{!ManageProposalActionBean.update and !ManageProposalActionBean.createNew}"
					update=":excelTable :manageProposal" style="width:70px;" />
				<p:commandButton id="cancelButton" immediate="true" process="@this"
					value="Cancel"
					action="#{ManageProposalActionBean.createNewProposal}"
					rendered="#{ManageProposalActionBean.showExcel}"
					update=":excelTable :manageProposal" style="width:70px;margin-left:-3px;" />
			</h:panelGrid>

			<p:separator style="height:3px" />
		</h:form>
		
		 <h:form enctype="multipart/form-data" id="excelTable" >
			<p:fileUpload fileUploadListener="#{ManageProposalActionBean.upload}" 
				mode="advanced" dragDropSupport="true" update="dataTable" />
				
			<h:dataTable value="#{ManageProposalActionBean.excelProposalDTOList}" 
			    var="data" id="dataTable" paginator="true" rows="10"
			    styleClass="myTable" style="width:100%;margin-bottom: 10px; border: 1px solid black;"
			    widgetVar="dataTable"
			    paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			    rowsPerPageTemplate="5,10,15" rowKey="#{data.id}" reflow="true"
			    rowIndexVar="var" paginatorPosition="bottom">
				<h:column>
			        <f:facet name="header">InsuredName</f:facet>
			        #{data.insuredName}
			    </h:column>
			    <h:column>
			        <f:facet name="header">Bank</f:facet>
			        #{data.bank}
			    </h:column>
			    <h:column>
			        <f:facet name="header">Address</f:facet>
			        #{data.address}
			    </h:column>
			    <h:column>
			        <f:facet name="header">Policy No</f:facet>
			        #{data.policyNo}
			    </h:column>
			    <h:column>
			        <f:facet name="header">SumInsured</f:facet>
			        #{data.sumInsured}
			    </h:column>
			    <h:column>
			        <f:facet name="header">Rate</f:facet>
			        #{data.rate}
			    </h:column>
			    <h:column>
			        <f:facet name="header">Premium</f:facet>
			        #{data.premium}
			    </h:column>
			     <h:column>
			        <f:facet name="header">Start Date</f:facet>
			        #{ManageProposalActionBean.formatDate(data.startDate)}
			    </h:column>
				<p:column style="width:4%;">
					<p:commandButton styleClass="green-button" icon="fa fa-paint-brush"
						action="#{ManageProposalActionBean.softPrepareUpdateProposal(data)}"
						process="@this" update=":excelTable :manageProposal" />
				</p:column>
				<p:column style="width:4%;">
					<p:commandButton styleClass="red-button" icon="fa fa-times" process="@this"
						action="#{ManageProposalActionBean.softDeleteProposal(data)}" update=":excelTable :manageProposal "  >
						<p:confirm header="Confirmation"
							message="are you sure to delete??"
							icon="fa fa-exclamation-triangle" />
					</p:commandButton>
				</p:column>
			</h:dataTable>
			
			<p:commandButton id="addBtn" value="Submit" styleClass="white"
				action="#{ManageProposalActionBean.addNewProposal}"
				update=":manageProposal :excelTable " style="width:65px;" rendered="#{ManageProposalActionBean.createNew}"/>
		</h:form>
   
			
		<!-- Confirmation Dialog -->
		<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
			<p:commandButton value="Yes" type="button"
				styleClass="ui-confirmdialog-yes" icon="fa fa-check" />
			<p:commandButton value="No" type="button"
				styleClass="ui-confirmdialog-no" icon="fa fa-times" />
		</p:confirmDialog>
   </ui:define>             
           
</ui:composition>